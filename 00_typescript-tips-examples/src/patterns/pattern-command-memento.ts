// Command pattern with memento architecture
